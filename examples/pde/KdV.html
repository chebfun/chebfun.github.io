<!DOCTYPE html>
<html>
  <head>
    <title>KdV solitons and non-solitons &raquo; Chebfun</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="shortcut icon" href="favicon.ico" />

    <!-- Bootstrap -->
    <link href="/css/bootstrap.min.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/normalize.min.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/chebsite.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/tomorrow.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/flexslider.css" rel="stylesheet"><!--  media="screen" -->

    <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic' rel='stylesheet' type='text/css'>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-4297200-10', 'chebfun.org');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>  </head>
  <body>
    <!-- Fixed navbar -->
    <div id='navbar' class="navbar navbar-default navbar-fixed-top">
      <div class="container nav">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
          <a id="logo" href="/"><img src='/images/logo.png' /></a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/about">About</a></li>
            <li><a href="/news">News</a></li>
            <li><a href="/download">Download</a></li>
            <li><a href="/docs">Docs</a></li>
            <li><a href="/examples">Examples</a></li>
            <li><a href="/support">Support</a></li>
            <li><a href="/search"><span class="glyphicon glyphicon-search"></span></a></li>
            <li><a href="http://github.com/chebfun/chebfun"><img id='github-logo' src='/css/github-logo.png'/></a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
<div class="page-wrapper">

    <div class='page-header'>
<h1>KdV solitons and non-solitons</h1>
<h2>Nick Trefethen, April 2016<span><a href='/examples/pde/KdV.m'>download</a><span class='sep-sm'>&middot;</span><a href='//github.com/chebfun/examples/tree/development/pde/KdV.m'>view on GitHub</a></span></h2>
</div>

    <div class="container">
<div class="row main">
<div id='content' class="col-sm-12 example" role="main">
<h3 id="1-soliton-solutions">1. Soliton solutions</h3>
<p>Chebfun's <code>spin</code> command makes it easy to compute solutions of the KdV equation, $$ u_t = -0.5(u^2)<em xxx="xxx">x - u</em>. $$ For example, let's set to work on $[0, 20]$ with a two-soliton initial condition $$ u_0(x) = 3A^2 \hbox{sech}(.5A(x-1))^2 + 3B^2 \hbox{sech}(.5B(x-2))^2 $$ where the amplitude parameters $A$ and $B$ are quite close to each other, taking values $25$ and $23$. We can set up for the calculation like this:</p>
<pre class="mcode-input">A = 25; B = 23;
dom = [0 20]; x = chebfun('x',dom);
tspan = [0 .0156];
S = spinop(dom,tspan);
S.linearPart = @(u) - diff(u,3);
S.nonlinearPart = @(u) -.5*diff(u.^2); % spin cannot parse "u.*diff(u)"
S.init = 3*A^2*sech(.5*A*(x-3)).^2 + 3*B^2*sech(.5*B*(x-4)).^2;</pre>

<p>Now let's perform the calculation. This initial condition corresponds to a pair of solitons with slightly different amplitudes and different speeds.  As $t$ increases, both pulses move right, with the taller one moving faster.  Around time $t=0.0078$, it overtakes the slower one, and around time $t=0.0156$, it is as far ahead at was originally behind.</p>
<pre class="mcode-input">pause off
tic, u = spin(S,spinpref('plot','off')); t = toc;
plot(S.init), hold on, plot(u), hold off</pre>

<p><img src="img/KdV_01.png" class="figure" alt=""/></p>
<p>When <code>spin</code> is run is this simple mode without extra arguments, it makes adaptive decisions along the way that may slow it down, especially for equations like this with no diffusion (the KdV) equation is dispersive, not diffusive). The calculation just carried out took quite a while:</p>
<pre class="mcode-input">t</pre>

<pre class="mcode-output">t =
  65.497760000000000
</pre>

<p>For practical work we can often do much better by fixing the grid and the time step, like this.  Here we do this and see that the image looks the same:</p>
<pre class="mcode-input">tic, u = spin(S,spinpref('plot','off','N',800,'dt',.00001)); t = toc;
plot(S.init), hold on, plot(u), hold off</pre>

<p><img src="img/KdV_02.png" class="figure" alt=""/></p>
<p>However, the computation is much faster:</p>
<pre class="mcode-input">t</pre>

<pre class="mcode-output">t =
   1.386784000000000
</pre>

<h3 id="2-non-soliton-solutions">2. Non-soliton solutions</h3>
<p>Soliton solutions are so celebrated that it is easy to forget that they are special.  Let us explore various other possibilities.</p>
<p>First of all, here is the taller of the two solitons just as before.</p>
<pre class="mcode-input">S.init = 3*A^2*sech(.5*A*(x-3)).^2;
u = spin(S,spinpref('plot','off','N',800,'dt',.00001));
plot(S.init), hold on, plot(u), hold off</pre>

<p><img src="img/KdV_03.png" class="figure" alt=""/></p>
<p>What if we make the initial pulse a bit wider?  This is no longer a soliton.  As $t$ increases, it breaks into a big soliton and a small one, plus some low-amplitude information that is not in the form of solitons.</p>
<pre class="mcode-input">S.init = 3*A^2*sech(.35*A*(x-3)).^2;
u = spin(S,spinpref('plot','off','N',800,'dt',.00001));
plot(S.init), hold on, plot(u), hold off</pre>

<p><img src="img/KdV_04.png" class="figure" alt=""/></p>
<p>If we make the pulse still wider, we get a beautiful train of solitons.</p>
<pre class="mcode-input">S.init = 3*A^2*sech(.05*A*(x-3)).^2;
u = spin(S,spinpref('plot','off','N',800,'dt',.00001));
plot(S.init), hold on, plot(u), hold off</pre>

<p><img src="img/KdV_05.png" class="figure" alt=""/></p>
<p>Let's try something a little bit random:</p>
<pre class="mcode-input">S.init = 500*(x-12).*exp(-(x-12).^2);
u = spin(S,spinpref('plot','off','N',800,'dt',.00001));
plot(S.init), hold on, plot(u), hold off</pre>

<p><img src="img/KdV_06.png" class="figure" alt=""/></p>
<h3 id="3-references">3. References</h3>
<p>The mathematics of solitons is thoroughly understood.  See for example [1].</p>
<p>[1] M. J. Ablowitz and H. Segur, <em>Solitons and the Inverse Scattering Transform</em>, SIAM, 1981.</p></div>
        </div>
    </div>
</div>
    <div class="footer">
        <p>&copy; Copyright 2014-2015 the University of Oxford and the Chebfun Developers.</p>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="https://google-code-prettify.googlecode.com/svn/loader/prettify.js?lang=matlab" type="text/javascript"></script>
    <script type="text/javascript" src="/js/config.js"></script>
    <script type="text/javascript" src="/js/jquery.flexslider-min.js"></script>
  </body>
</html>