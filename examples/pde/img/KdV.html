---
title: "KdV solitons and non-solitons"
layout: example
authordate: "Nick Trefethen, April 2016"
meta: "(Chebfun Example pde/KdV.m) [Tags: #KdV , #spin]"
---



## 1. Soliton solutions

Chebfun's `spin` command makes it easy to compute solutions of the KdV equation, $$ u_t = -0.5(u^2)_x - u_{xxx}. $$ For example, let's set to work on $[0,20]$ with a two-soliton initial condition $$ u_0(x) = 3A^2 \hbox{sech}(.5A(x-1))^2 + 3B^2 \hbox{sech}(.5B(x-2))^2 $$ where the amplitude parameters $A$ and $B$ are quite close to each other, taking values $25$ and $23$. We can set up for the calculation like this:

<pre class="mcode-input">A = 25; B = 23;
dom = [0 20]; x = chebfun('x',dom);
tspan = [0 .0156];
S = spinop(dom,tspan);
S.linearPart = @(u) - diff(u,3);
S.nonlinearPart = @(u) -.5*diff(u.^2); % spin cannot parse "u.*diff(u)"
S.init = 3*A^2*sech(.5*A*(x-3)).^2 + 3*B^2*sech(.5*B*(x-4)).^2;</pre>Now let's perform the calculation. This initial condition corresponds to a pair of solitons with slightly different amplitudes and different speeds.  As $t$ increases, both pulses move right, with the taller one moving faster.  Around time $t=0.0078$, it overtakes the slower one, and around time $t=0.0156$, it is as far ahead at was originally behind.

<pre class="mcode-input">pause off
tic, u = spin(S,spinpref('plot','off')); t = toc;
plot(S.init), hold on, plot(u), hold off
text(5,1500,'t = 0'), text(14.5,1500,'t = 0.015')</pre><img src="img/KdV_01.png" class="figure" alt=""/>

When `spin` is run is this simple mode without extra arguments, it makes adaptive decisions along the way that may slow it down, especially for equations like this with no diffusion (the KdV) equation is dispersive, not diffusive). The calculation just carried out took quite a while:

<pre class="mcode-input">t</pre><pre class="mcode-output">t =
  46.539315000000002
</pre>For practical work we can often do much better by fixing the grid and the time step, like this.  Here we do this and see that the image looks the same:

<pre class="mcode-input">tic, u = spin(S,spinpref('plot','off','N',800,'dt',.00001)); t = toc;
plot(S.init), hold on, plot(u), hold off</pre><img src="img/KdV_02.png" class="figure" alt=""/>

However, the computation is much faster:

<pre class="mcode-input">t</pre><pre class="mcode-output">t =
   1.286295000000000
</pre>Of course, the result of a spin computation is a chebfun. So we can for example easily compute the amplitude of this final function $u$:

<pre class="mcode-input">max(u)</pre><pre class="mcode-output">ans =
     1.853246362348295e+03
</pre>This agrees reasonably well with the initial amplitude, as it should since it's the same soliton.

<pre class="mcode-input">initial_amplitude = 3*A^2</pre><pre class="mcode-output">initial_amplitude =
        1875
</pre>In fact, the KdV equation like other equations of completely integrable systems has an infinite collection of conservation laws. Chebfun could be used to explore these.



## 2. Non-soliton solutions

Soliton solutions are so celebrated that it is easy to forget that they are special.  Let us explore various other possibilities.

First of all, here is the taller of the two solitons just as before.

<pre class="mcode-input">S.init = 3*A^2*sech(.5*A*(x-3)).^2;
u = spin(S,spinpref('plot','off','N',800,'dt',.00001));
plot(S.init), hold on, plot(u), hold off</pre><img src="img/KdV_03.png" class="figure" alt=""/>

What if we make the initial pulse a bit wider?  This is no longer a soliton.  As $t$ increases, it breaks into a big soliton and a small one, plus some low-amplitude information that is not in the form of solitons.

<pre class="mcode-input">S.init = 3*A^2*sech(.35*A*(x-3)).^2;
u = spin(S,spinpref('plot','off','N',800,'dt',.00001));
plot(S.init), hold on, plot(u), hold off</pre><img src="img/KdV_04.png" class="figure" alt=""/>

If we make the pulse still wider, we get a beautiful train of solitons.  Note that a term centered at $x=23$ has been added to make this wider pulse numerically periodic.

<pre class="mcode-input">S.init = 3*A^2*( sech(.05*A*(x-3)).^2 + sech(.05*A*(x-23)).^2 );
u = spin(S,spinpref('plot','off','N',800,'dt',.00001));
plot(S.init), hold on, plot(u), hold off</pre><img src="img/KdV_05.png" class="figure" alt=""/>

Let's try something a little bit random:

<pre class="mcode-input">S.init = 500*(x-12).*exp(-(x-12).^2);
u = spin(S,spinpref('plot','off','N',800,'dt',.00001));
plot(S.init), hold on, plot(u), hold off</pre><img src="img/KdV_06.png" class="figure" alt=""/>



## 3. Conservation laws

The function $u$ is a conserved quantity for the KdV equation in the sense that its integral remains constant.  Here we confirm this numerically (the integral is zero since the function is :

<pre class="mcode-input">u0 = S.init;
conserved1 = @(u) sum(u)
conserved1(u), conserved1(u0)</pre><pre class="mcode-output">conserved1 = 
    @(u)sum(u)
ans =
     3.160138817293045e-13
ans =
     3.575813691433471e-13
</pre>Another conserved quantity is $u^2$:

<pre class="mcode-input">conserved2 = @(u) sum(u.^2)
conserved2(u), conserved2(u0)</pre><pre class="mcode-output">conserved2 = 
    @(u)sum(u.^2)
ans =
     7.833213352716355e+04
ans =
     7.833213358221890e+04
</pre>In fact, as a completely integrable system, the KdV equation has an infinite set of conserved quantities [2,3].  Another one is $u^3/3 - (u_x)^2$:

<pre class="mcode-input">conserved3 = @(u) sum(u.^3/3 - diff(u).^2)
conserved3(u), conserved3(u0)</pre><pre class="mcode-output">conserved3 = 
    @(u)sum(u.^3/3-diff(u).^2)
ans =
    -2.349964045069835e+05
ans =
    -2.349964007466361e+05
</pre>Another is  $u^4/4 - 3u(u_x)^2 + (9/5)(u_{xx})^2$:

<pre class="mcode-input">conserved4 = @(u) sum(u.^4/4 - 3*u.*diff(u).^2 + (9/5)*diff(u,2).^2)
conserved4(u), conserved4(u0)</pre><pre class="mcode-output">conserved4 = 
    @(u)sum(u.^4/4-3*u.*diff(u).^2+(9/5)*diff(u,2).^2)
ans =
     6.512069535782971e+08
ans =
     6.512069540223162e+08
</pre>

## 4. References

The mathematics of solitons is thoroughly understood.  See for example [1].  For a quick introduction to the KdV equation, see [2].

[1] M. J. Ablowitz and H. Segur, _Solitons and the Inverse Scattering Transform_, SIAM, 1981.

[2] L. N. Trefethen and K. Embree, editors, article on "The KdV equation", _The (Unfinished) PDE Coffee Table Book_, `https://people.maths.ox.ac.uk/trefethen/pdectb.html`.

[3] G. Whitham, _Linear and Nonlinear Waves_, Wiley, 1974.

