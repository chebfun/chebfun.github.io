<!DOCTYPE html>
<html>
  <head>
    <title>Pretty functions approximated by Chebfun2 &raquo; Chebfun</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="shortcut icon" href="favicon.ico" />

    <!-- Bootstrap -->
    <link href="/css/bootstrap.min.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/normalize.min.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/chebsite.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/tomorrow.css" rel="stylesheet"><!--  media="screen" -->
    <link href="/css/flexslider.css" rel="stylesheet"><!--  media="screen" -->

    <link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic' rel='stylesheet' type='text/css'>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-4297200-10', 'chebfun.org');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>  </head>
  <body>
    <!-- Fixed navbar -->
    <div id='navbar' class="navbar navbar-default navbar-fixed-top">
      <div class="container nav">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
          <a id="logo" href="/"><img src='/images/logo.png' /></a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/about">About</a></li>
            <li><a href="/news">News</a></li>
            <li><a href="/download">Download</a></li>
            <li><a href="/docs">Docs</a></li>
            <li><a href="/examples">Examples</a></li>
            <li><a href="/support">Support</a></li>
            <li><a href="/search"><span class="glyphicon glyphicon-search"></span></a></li>
            <li><a href="https://github.com/chebfun/chebfun"><img id='github-logo' src='/css/github-logo.png'/></a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
<div class="page-wrapper">

    <div class='page-header'>
<h1>Pretty functions approximated by Chebfun2</h1>
<h2>Alex Townsend, March 2013 in <a href='/examples/approx2/'>approx2</a><span><a href='/examples/approx2/PrettyFunctions.m'>download</a><span class='sep-sm'>&middot;</span><a href='//github.com/chebfun/examples/blob/master/approx2/PrettyFunctions.m'>view on GitHub</a></span></h2>
</div>

    <div class="container">
<div class="row main">
<div id='content' class="col-sm-12 example" role="main">
<h3 id="pretty-functions">Pretty functions</h3>
<p>Chebfun2 has half a dozen plotting commands such as <code>plot</code>, <code>plot3</code>, <code>surf</code>, <code>surfc</code>, <code>mesh</code>, and <code>waterfall</code>. In this example we use some of them to make pretty pictures.</p>
<h3 id="contour-and-pivot-plot">Contour and pivot plot</h3>
<p>The Chebfun2 <code>contour</code> command displays level curves and is analogous to the MATLAB <code>contour</code> command.  On the other hand, the pivot plot, with syntax <code>plot(f,'.')</code>, displays the locations of the pivots used during the construction process.  The number of pivots is equal to the rank of the chebfun2 object. Here are a selection of our favourite Chebfun2 contour plots along with the pivot locations that were selected during construction.</p>
<p>Six pretty functions:</p>
<pre class="mcode-input">f1 = @(x,y) 1./(1+100*(x.^2-y.^2).^2);                   F1 = chebfun2(f1);
f2 = @(x,y) 1./(1+100*(.5-x.^2-y.^2).^2);                F2 = chebfun2(f2);
f3 = @(x,y) 1./(1+1e3*((x.^2-.25).^2.*(y.^2-.25).^2));   F3 = chebfun2(f3);
f4 = @(x,y) cos(10*(x.^2+y)).*sin(10*(x+y.^2));          F4 = chebfun2(f4);
f5 = @(x,y) real(airy(5*(x+y.^2)).*airy(-5*(x.^2+y.^2)));F5 = chebfun2(f5);
f6 = @(x,y) tanh(10*x).*tanh(10*y)./tanh(10).^2+cos(5*x);F6 = chebfun2(f6);</pre>

<p>Six pretty plots:</p>
<pre class="mcode-input">n = 500; MS = 'MarkerSize'; ms=10; d = [-1,1,-1,1];
subplot(2,3,1), contour(F1,'numpts',n), plot(F1,'.k',MS,ms), axis(d)
subplot(2,3,2), contour(F2,'numpts',n), plot(F2,'.k',MS,ms), axis(d)
subplot(2,3,3), contour(F3,'numpts',n), plot(F3,'.k',MS,ms), axis(d)
subplot(2,3,4), contour(F4,'numpts',n), plot(F4,'.k',MS,ms), axis(d)
subplot(2,3,5), contour(F5,'numpts',n), plot(F5,'.k',MS,ms), axis(d)
subplot(2,3,6), contour(F6,'numpts',n), plot(F6,'.k',MS,ms), axis(d)</pre>

<p><img src="img/PrettyFunctions_01.png" class="figure" alt=""></p>
<h3 id="the-plot-command">The <code>plot</code> command</h3>
<p>The <code>plot</code> command can be used to visualise the surface of a chebfun2. The height of the surface above $(x,y)$ is equal to the value of $f(x,y)$. Here are four examples.</p>
<pre class="mcode-input">C=1000; g1=@(x,y) tanh(C*x)/tanh(C).*tanh(C*y)/tanh(C); G1 = chebfun2(g1);
g2 = @(x,y) 1./(1+200*((x-.3).^2.*(y+.5).^2));          G2 = chebfun2(g2);
g3 = @(x,y) 1./(1+100*(x - y).^2);                      G3 = chebfun2(g3);
g4 = @(x,y) 1./(1+100*(.5 - x.^2 - y.^2).^2);           G4 = chebfun2(g4);

subplot(2,2,1), plot(G1), zlim([-1 3])
subplot(2,2,2), plot(G2), zlim([-1 3])
subplot(2,2,3), plot(G3), zlim([-1 3])
subplot(2,2,4), plot(G4), zlim([-1 3])</pre>

<p><img src="img/PrettyFunctions_02.png" class="figure" alt=""></p>
<h3 id="the-waterfall-command">The <code>waterfall</code> command</h3>
<p>The <code>waterfall</code> command displays the lines on which the function was sampled in order to form the chebfun2 approximant. The positions of the lines were calculated by the adaptive construction process. Here are Franke's function and the lines on which it was sampled to form an approximation.</p>
<pre class="mcode-input">h = @(x,y) .75*exp(-((9*x-2).^2 + (9*y-2).^2)/4) + ...
           .75*exp(-((9*x+1).^2)/49 - (9*y+1)/10) + ...
           .5*exp(-((9*x-7).^2 + (9*y-3).^2)/4) - ...
           .2*exp(-(9*x-4).^2 - (9*y-7).^2);
H = chebfun2(h);
clf, waterfall(H,'-')</pre>

<p><img src="img/PrettyFunctions_03.png" class="figure" alt=""></p>
<h3 id="phase-portraits">Phase portraits</h3>
<p>For plots of complex valued functions see the Phase portraits example [1] and Section 1.7 of the Chebfun2 guide.</p>
<h3 id="references">References</h3>
<ol>
<li>Chebfun example <a href="../complex/PhasePortraits.html">complex/PhasePortraits</a></li>
</ol></div>
        </div>
    </div>
</div>
    <div class="footer">
        <p>&copy; Copyright 2019 the University of Oxford and the Chebfun Developers.</p>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.7.2.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=matlab" type="text/javascript"></script>
    <script type="text/javascript" src="/js/config.js"></script>
    <script type="text/javascript" src="/js/jquery.flexslider-min.js"></script>
  </body>
</html>