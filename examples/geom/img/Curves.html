---
title: "Distance between two curves"
layout: example
authordate: "Nick Trefethen, November 2022"
meta: "(Chebfun example geom/Curves.m)"
---

Suppose we have two curves, like these,

<pre class="mcode-input">tic, rng(1), LW = 'linewidth'; MS = 'markersize';
t = chebfun('t');
f = 1i*t + .2*randnfun(.5) - 1;
g = 1i*t + .2*randnfun(.5) + 1;
plot([f g],'linewidth',2), axis equal, grid on</pre><img src="img/Curves_01.png" class="figure" alt="">

and we want to know the closest distance between them. (This is a great simplification of a problem John Maddocks brought up at lunch today.)  I am sure there is a lot known about how to compute this.

One approach is to simply make a chebfun2 $d(x,y)$ representing the distance between $f(x)$ and $g(y)\dots$

<pre class="mcode-input">d = chebfun2(@(x,y) abs(f(x)-g(y)));
contour(d,LW,1), axis equal, colorbar, xlabel x, ylabel y</pre><img src="img/Curves_02.png" class="figure" alt="">

$\dots$ and find the global minimum:

<pre class="mcode-input">[mindist,pos] = min2(d); x = f(pos(1)); y = g(pos(2));
plot([f g],'linewidth',2), axis equal, grid on
hold on, plot([x y],'--k',LW,1.2), plot([x y],'.k',MS,20), hold off
title(['minimum distance: ' num2str(mindist)]), toc</pre><pre class="mcode-output">Elapsed time is 2.990995 seconds.
</pre><img src="img/Curves_03.png" class="figure" alt="">

